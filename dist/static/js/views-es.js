import{d as $,r as v,a as M,c as w,b as o,e as x,t as S,o as b,p as P,f as V,g as h,w as g,u as R,E as T,h as B,i as E,S as z,P as D,W as G,C as U,A,j as W,M as O,k as j,B as H,l as N,m as q,n as F,F as J,q as K,s as Q,v as X,x as Y,y as Z,$ as ee,z as te}from"./vendor-es.js";const L=n=>(P("data-v-45838999"),n=n(),V(),n),oe={class:"home"},se=L(()=>o("h1",null,"home page",-1)),ne=L(()=>o("br",null,null,-1)),ae=$({__name:"index",setup(n){const a=v(0),s=M({nested:{count:0},arr:["foo","bar"]}),c=()=>{a.value++,s.nested.count+=2};return(l,r)=>(b(),w("div",oe,[se,o("div",{class:"count",id:"count",onClick:c},[x(" Click "),o("span",null,S(a.value),1),ne,o("span",null,S(s.nested.count),1)])]))}});const C=(n,a)=>{const s=n.__vccOpts||n;for(const[c,l]of a)s[c]=l;return s},ce=C(ae,[["__scopeId","data-v-45838999"]]),Re=Object.freeze(Object.defineProperty({__proto__:null,default:ce},Symbol.toStringTag,{value:"Module"})),le=n=>(P("data-v-bb7e5c32"),n=n(),V(),n),ie={class:"webrtc-container"},re=le(()=>o("div",{class:"local-video"},[o("video",{id:"localVideo",autoplay:"",playsinline:"",muted:""})],-1)),de={class:"control"},ue=$({__name:"record",setup(n){function a(d=s){const u=document.querySelector("#localVideo");u.srcObject=d,u.onloadedmetadata=()=>{u.play()}}let s;async function c(){s=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0}),a(),r.value=!0}function l(){s.getTracks().forEach(d=>{d.stop()}),r.value=!1}let r=v(!1);function y(){r.value?l():c()}async function i(){s=await navigator.mediaDevices.getDisplayMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:{width:1920,height:1080,frameRate:60,aspectRatio:16/9}}),a()}const m=v(0);let e;function t(){if(!s){T.warning("请先获取本地音视频流");return}if((e==null?void 0:e.state)==="recording"){e.stop();return}const d={audioBitsPerSecond:128e3,videoBitsPerSecond:25e5,mimeType:'video/webm; codecs="vp8,opus"'},u=[];let p;e=new MediaRecorder(s,d),e.start(),e.ondataavailable=f=>{u.push(f.data)},e.onstart=()=>{p=setInterval(()=>{m.value++},1e3)},e.onstop=()=>{m.value=0,clearInterval(p);const f=new Blob(u,{type:e==null?void 0:e.mimeType});_(f),u.length=0}}function _(d){const u=URL.createObjectURL(d),p=document.createElement("a");p.href=u,p.download=`${new Date().getTime()}.${d.type.split("/")[1].split(";")[0]}`,p.click(),URL.revokeObjectURL(u)}return(d,u)=>{const p=B;return b(),w("div",ie,[re,o("div",de,[o("div",null,[h(p,{type:R(r)?"warning":"primary",onClick:y},{default:g(()=>[x(S(R(r)?"关闭摄像头":"打开摄像头"),1)]),_:1},8,["type"]),h(p,{type:"primary",onClick:i},{default:g(()=>[x("分享屏幕")]),_:1}),h(p,{type:m.value===0?"success":"warning",onClick:t},{default:g(()=>[x(S(m.value===0?" 开始录制":"终止录制 | "+m.value),1)]),_:1},8,["type"])])])])}}});const _e=C(ue,[["__scopeId","data-v-bb7e5c32"]]),Te=Object.freeze(Object.defineProperty({__proto__:null,default:_e},Symbol.toStringTag,{value:"Module"})),pe=$({__name:"FirstScene",setup(n){const a=v();function s(){var k;const c=new z,l=new D(45,window.innerWidth/window.innerHeight,.1,1e3),r=new G;r.setClearColor(new U(0)),r.setSize(window.innerWidth,window.innerHeight);const y=new A(20);c.add(y);const i=new W(60,20),m=new O({color:11184810}),e=new j(i,m);e.rotation.x=-.5*Math.PI,e.position.set(15,0,0),c.add(e);const t=new H(4,4,4),_=new O({color:16711680,wireframe:!0}),d=new j(t,_);d.position.set(-4,3,0),c.add(d);const u=new N(4,20,20),p=new O({color:7829503,wireframe:!0}),f=new j(u,p);f.position.set(20,4,2),c.add(f),l.position.set(-30,40,30),l.lookAt(c.position),(k=a.value)==null||k.appendChild(r.domElement),r.render(c,l)}return E(()=>{s()}),v("BasicSkeleton"),(c,l)=>(b(),w("div",{class:"three",ref_key:"threeRef",ref:a},null,512))}}),me={style:{position:"absolute",top:"0"}},ve=$({__name:"index",setup(n){return(a,s)=>(b(),w("div",me,[h(pe)]))}}),Ee=Object.freeze(Object.defineProperty({__proto__:null,default:ve},Symbol.toStringTag,{value:"Module"})),fe={class:"ChatRoom"},he={class:"wsMsg"},ye={id:"messages"},ge=$({__name:"index",setup(n){const a=v(""),s=v(),c=(e,t,_)=>{if(t==="")return _(new Error("Please input the message"));setTimeout(()=>{_()},500)},l=M({message:""}),r=M({message:[{validator:c,trigger:"blur"}]}),y=e=>{e&&e.validate(t=>{var _;if(t&&i.value)i.value.emit("chat message",l.message),(_=s.value)==null||_.resetFields();else return console.log("error submit!"),!1})},i=v(),m=M({list:[]});return E(()=>{const e=window.location.hostname;i.value=q(`https://${e}:6789`),i.value.on("connect",()=>{var t,_;a.value=`用户ID: ${(t=i.value)==null?void 0:t.id}`,console.log((_=i.value)==null?void 0:_.id)}),i.value.on("connect_error",()=>{setTimeout(()=>{a.value="错误信息: Connect_Error"},2e3)}),i.value.on("disconnect",()=>{var t;console.log((t=i.value)==null?void 0:t.id)}),i.value.on("message",t=>{m.list.push(t)})}),F(()=>{i.value&&i.value.close()}),(e,t)=>{const _=Y,d=Z,u=B,p=X;return b(),w("div",fe,[o("div",he,S(a.value),1),o("ul",ye,[(b(!0),w(J,null,K(m.list,(f,k)=>(b(),w("li",{key:k},S(f),1))),128))]),h(p,{ref_key:"wsFormRef",ref:s,model:l,"status-icon":"",rules:r,"label-width":"120px",class:"wsForm",size:"large",inline:!0,onSubmit:t[2]||(t[2]=Q(()=>{},["prevent"]))},{default:g(()=>[h(d,{prop:"message",class:"message"},{default:g(()=>[h(_,{modelValue:l.message,"onUpdate:modelValue":t[0]||(t[0]=f=>l.message=f),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),h(d,{class:"sumbit"},{default:g(()=>[h(u,{type:"primary",onClick:t[1]||(t[1]=f=>y(s.value)),"native-type":"submit"},{default:g(()=>[x(" 发送 ")]),_:1})]),_:1})]),_:1},8,["model","rules"])])}}});const we=C(ge,[["__scopeId","data-v-39f7a668"]]),Fe=Object.freeze(Object.defineProperty({__proto__:null,default:we},Symbol.toStringTag,{value:"Module"})),I=n=>(P("data-v-dc225352"),n=n(),V(),n),be={class:"peer"},Se={class:"user-info"},xe={class:"user-info-id"},$e={class:"videos"},ke={class:"video"},Me=I(()=>o("h3",{class:"title"},"Local",-1)),Ce=I(()=>o("h3",{class:"title"},"OfferSDP",-1)),Ie={class:"video"},Oe=I(()=>o("h3",{class:"title"},"Remote",-1)),je=I(()=>o("h3",{class:"title"},"AnswerSDP",-1)),Pe=$({__name:"index",setup(n){const a=v(""),s=v(null),c=v(null),l=v(new ee({host:"101.201.140.172",path:"peer",port:9011}));l.value.on("open",y=>{a.value=y}).on("disconnected",()=>{console.log("disconnected")});const r=()=>{te.copy(a.value),T.success("复制成功")};return F(()=>{l.value.destroy()}),(y,i)=>{const m=B;return b(),w("div",be,[o("div",Se,[o("div",xe,S(a.value),1),h(m,{type:"primary",onClick:r},{default:g(()=>[x("复制")]),_:1})]),o("div",$e,[o("div",ke,[Me,o("video",{autoplay:"",height:"300",width:"300",id:"localVideo",ref_key:"localVideo",ref:s},null,512),Ce]),o("div",Ie,[Oe,o("video",{autoplay:"",height:"300",width:"300",id:"remoteVideo",ref_key:"remoteVideo",ref:c},null,512),je])])])}}});const Ve=C(Pe,[["__scopeId","data-v-dc225352"]]),Le=Object.freeze(Object.defineProperty({__proto__:null,default:Ve},Symbol.toStringTag,{value:"Module"}));export{Ee as a,Fe as b,Le as c,Re as i,Te as r};
